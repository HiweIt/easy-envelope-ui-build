import{aE as M,aF as C,bp as w,z as R,ah as V,aj as H,c as s,B as I,C as L,O as K,d as _,r as Q,w as k,o as W,A as J,bA as X,u as x,g as m,l as h,p as d,j as A,aD as j,aB as B,i as v,D as Y,M as Z,m as g,t as z,aP as ee,v as T,n as te}from"./index.89b9ec57.js";import{Q as ae}from"./QPage.012d8f48.js";import{H as ne}from"./hq-data-table.es.fec03429.js";import{D as u,L as c}from"./Constants.1a4c5247.js";import{u as E}from"./use-quasar.9ffcffad.js";import"./ClosePopup.345e3494.js";import"./QTooltip.294f16a1.js";import"./position-engine.46944299.js";import"./QSelect.0fc3481c.js";import"./QItem.63231d09.js";import"./QMenu.bf3c5da3.js";import"./rtl.b51694b1.js";import"./format.2bc25e5f.js";import"./QScrollObserver.90b5c25e.js";import"./QTabs.07f3fc81.js";import"./QImg.b1f8a295.js";import"./QSpace.3975ae39.js";import"./QInnerLoading.8283329e.js";import"./QBtnDropdown.426df4de.js";import"./QList.744acb19.js";import"./QTable.74b7a1a0.js";import"./QMarkupTable.dcbee181.js";import"./use-fullscreen.76803ed0.js";const oe=M("dashboard",{state:()=>({barChartData:[],pieChartData:[],planAndQuota:void 0,tableData:[]}),actions:{async getEmailHistory(){const e={controller:"emailmetadata",function:"getAllForTableByUserId",router:this.router},t=await C(e,[w().user.id]);t&&(this.tableData=t)},async getBarChartData(){const e={controller:"emailmetadata",function:"getForGraphByUserId",router:this.router},t=await C(e,[w().user.id]);this.barChartData=t.length?t:[{cnt:0,month:new Date().toLocaleDateString("en-GB",{month:"2-digit",year:"numeric"}).replace(/\//g,".")}]},async getPieChartData(){const e={controller:"emailtemplate",function:"getTemplateForGraphByUserId",router:this.router},t=await C(e,[w().user.id]);this.pieChartData=t||[]},async getUserPlanDTO(){const e={controller:"priceplan",function:"getPlanAndQuotaByUserId",router:this.router},t=await C(e,[w().user.id]);t&&(this.planAndQuota=t)}}}),le=["text","rect","circle","QBtn","QBadge","QChip","QToolbar","QCheckbox","QRadio","QToggle","QSlider","QRange","QInput","QAvatar"],re=["wave","pulse","pulse-x","pulse-y","fade","blink","none"];var F=R({name:"QSkeleton",props:{...V,tag:{type:String,default:"div"},type:{type:String,validator:e=>le.includes(e),default:"rect"},animation:{type:String,validator:e=>re.includes(e),default:"wave"},animationSpeed:{type:[String,Number],default:1500},square:Boolean,bordered:Boolean,size:String,width:String,height:String},setup(e,{slots:t}){const a=K(),n=H(e,a.proxy.$q),r=s(()=>{const o=e.size!==void 0?[e.size,e.size]:[e.width,e.height];return{"--q-skeleton-speed":`${e.animationSpeed}ms`,width:o[0],height:o[1]}}),l=s(()=>`q-skeleton q-skeleton--${n.value===!0?"dark":"light"} q-skeleton--type-${e.type}`+(e.animation!=="none"?` q-skeleton--anim q-skeleton--anim-${e.animation}`:"")+(e.square===!0?" q-skeleton--square":"")+(e.bordered===!0?" q-skeleton--bordered":""));return()=>I(e.tag,{class:l.value,style:r.value},L(t.default))}});const $="https://www.gstatic.com/charts/loader.js";let D=null;const S=new Map;function ie(){return window.google!==void 0?Promise.resolve(window.google.charts):(D===null&&(D=new Promise(e=>{const t=document.querySelector('script[src="'.concat($,'"]')),a=t||document.createElement("script");t||(a.src=$,a.type="text/javascript",document.head.append(a)),a.onload=()=>{window.google!==void 0&&e(window.google.charts)}})),D)}async function se(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"current",{packages:t=["corechart","controls"],language:a="en",mapsApiKey:n}=arguments.length>1?arguments[1]:void 0;const r=await ie(),l="".concat(e,"_").concat(t.join("_"),"_").concat(a);if(S.has(l))return S.get(l);const o=new Promise(i=>{r.load(e,{packages:t,language:a,mapsApiKey:n}),r.setOnLoadCallback(()=>i(window.google))});return S.set(l,o),o}function ue(e,t,a){return e!==null&&t instanceof e.visualization.DataTable||e!==null&&t instanceof e.visualization.DataView?t:e!==null&&Array.isArray(t)?e.visualization.arrayToDataTable(t,a):e!==null&&t!==null&&typeof t=="object"?new e.visualization.DataTable(t):null}function N(e,t,a,n,r,l){const o=(b,f,p)=>{if(p===void 0)throw new Error("please, provide chart type property");return new f.visualization[p](b)};if(e===null)throw new Error("please, provide charts lib property");if(a===null)throw new Error("please, provide chart element property");return t=(l||o)(a,e,n),ce(e,t,r),t}function ce(e,t,a){if(a!==null)for(const[n,r]of Object.entries(a))e!==null&&t!==null&&e.visualization.events.addListener(t,n,r)}function O(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:50,a;function n(){return t}return function(){for(var l=arguments.length,o=new Array(l),i=0;i<l;i++)o[i]=arguments[i];const b=this,f=function(){a=void 0,e.apply(b,o)};a!==void 0&&clearTimeout(a),a=setTimeout(f,n())}}let y=null;const P=_({name:"GChart",props:{type:{type:String,required:!0},data:{type:[Array,Object,null],default:()=>[]},isFirstRowLabels:{type:Boolean,default:!1},options:{type:Object,default:()=>({})},version:{type:String,default:"current"},settings:{type:Object,default:()=>({packages:["corechart","table"]})},events:{type:Object,default:null},createChart:{type:Function,default:void 0},resizeDebounce:{type:Number,default:200}},setup(e,t){let{emit:a}=t;const n=Q(null),r=Q(null);function l(){if(y===null||n.value===null)return;const o=ue(y,e.data,e.isFirstRowLabels);if(o!==null){var i;(i=n.value)===null||i===void 0||i.draw(o,e.options)}}return k(()=>e.data,()=>l(),{deep:!0}),k(()=>e.options,()=>l(),{deep:!0}),k(()=>e.type,()=>{n.value=N(y,n.value,r.value,e.type,e.events,e.createChart),l()}),W(()=>{se(e.version,e.settings).then(o=>{o!==void 0&&(y=o,n.value=N(y,n.value,r.value,e.type,e.events,e.createChart),a("ready",n.value,o),l())}),e.resizeDebounce>0&&window.addEventListener("resize",O(l,e.resizeDebounce))}),J(()=>{n.value!==null&&typeof n.value.clearChart=="function"&&n.value.clearChart(),e.resizeDebounce>0&&window.removeEventListener("resize",O(l,e.resizeDebounce))}),()=>I("div",{ref:r},[])}}),U=X({});function de(){U.component("GChart",P)}const ge={version:"1.1.0",install:de};let q=null;typeof window!="undefined"&&(q=window.Vue);q!=null&&U.use(ge);const me=_({__name:"GoogleBarChart",props:{data:{default:()=>[]},loading:{type:Boolean,default:!1}},setup(e){const t=e,{t:a}=x({useScope:"global"}),n=E(),r=s(()=>{const o=[];return o.push(["Month","Count",{role:"style"}]),t.data.forEach(i=>{o.push([i.month,i.cnt,"opacity: 0.7"])}),o}),l=s(()=>({backgroundColor:n.dark.isActive?u:c,chartArea:{height:"100%",width:"100%",top:"10%",left:"4%",bottom:"8%",right:"0%"},hAxis:{baselineColor:n.dark.isActive?c:u,gridlines:{color:n.dark.isActive?"#AAA":"#888"},minorGridlines:{color:n.dark.isActive?"#AAA":"#888"},textStyle:{color:n.dark.isActive?c:u}},height:340,legend:{position:"none",textStyle:{baselineColor:n.dark.isActive?c:u,color:n.dark.isActive?c:u}},titleTextStyle:{color:n.dark.isActive?c:u},title:a("notificationsPerMonth"),vAxis:{baselineColor:n.dark.isActive?c:u,gridlines:{color:n.dark.isActive?"#AAA":"#888"},minorGridlines:{color:n.dark.isActive?"#AAA":"#888"},textStyle:{color:n.dark.isActive?c:u}}}));return(o,i)=>o.loading?(m(),h(F,{key:0,height:`${l.value.height}px`},null,8,["height"])):(m(),h(d(P),{key:1,type:"ColumnChart",data:r.value,options:l.value},null,8,["data","options"]))}}),he=_({__name:"GooglePieChart",props:{data:{default:()=>[]},loading:{type:Boolean,default:!1}},setup(e){const t=e,{t:a}=x({useScope:"global"}),n=E(),r=s(()=>{const o=[];return o.push(["Template","Percent"]),t.data.forEach(i=>{o.push([i.templateName,i.cnt])}),o}),l=s(()=>({backgroundColor:n.dark.isActive?u:c,chartArea:{height:"100%",width:"100%",top:"10%",left:"4%",bottom:"8%",right:"0%"},height:340,legend:{position:"right",textStyle:{color:n.dark.isActive?c:u}},title:a("usagePerTemplate"),titleTextStyle:{color:n.dark.isActive?c:u}}));return(o,i)=>o.loading?(m(),h(F,{key:0,height:`${l.value.height}px`},null,8,["height"])):(m(),h(d(P),{key:1,type:"PieChart",data:r.value,options:l.value},null,8,["data","options"]))}});const pe={class:"text-h5 text-white customItem"},fe={class:"text-subtitle2 text-white"},G=_({__name:"DashboardCard",props:{icon:{default:"dashboard"},loading:{type:Boolean,default:!1},title:{default:"Title"},subtitle:{default:"Subtitle"}},setup(e){const t=e,a=s(()=>t.icon),n=s(()=>t.title),r=s(()=>t.subtitle);return(l,o)=>(m(),h(j,{flat:"",class:"bg-blue-6 card-hover"},{default:A(()=>[l.loading?(m(),h(B,{key:0,class:"text-center"},{default:A(()=>[v(Y,{color:"white",size:"3em"})]),_:1})):(m(),h(B,{key:1},{default:A(()=>[v(Z,{name:a.value,class:"dashboardIcon",color:"blue-8"},null,8,["name"]),g("div",pe,z(n.value),1),g("div",fe,z(r.value),1)]),_:1}))]),_:1}))}}),ve={class:"row justify-center q-col-gutter-md"},be={class:"col-12 col-lg-3 col-xl-2"},ye={class:"row q-col-gutter-md"},we={class:"col-12 col-sm-6 col-lg-12"},Ae={class:"col-12 col-sm-6 col-lg-12"},_e={class:"col-12 col-lg-5 col-xl-6"},Ce={class:"col-12 col-lg-4"},ke={class:"col-12"},We=_({__name:"DashboardPage",setup(e){const{t}=x({useScope:"global"}),a=oe(),n=Q(!0),r=s(()=>[{name:"date",label:t("date"),field:"date",align:"left",sortable:!0},{name:"badge",label:t("result"),field:"message",align:"left",sortable:!0,color:"color"},{name:"serviceName",label:t("serviceName"),field:"serviceName",align:"left",sortable:!0},{name:"templateName",label:t("templateName"),field:"templateName",align:"left",sortable:!0}]),l=s(()=>a.barChartData),o=s(()=>a.pieChartData),i=s(()=>a.planAndQuota?`${a.planAndQuota.planName} (${a.planAndQuota.quota!==-1?a.planAndQuota.quota:t("unlimited")})`:""),b=s(()=>a.planAndQuota?a.planAndQuota.quota!==-1?a.planAndQuota.quota-a.planAndQuota.usedQuota>0?a.planAndQuota.quota-a.planAndQuota.usedQuota:0:t("unlimited"):""),f=s(()=>a.tableData);return ee(async()=>{const p=w();p.user.id===null&&await p.fetchUserData(),await a.getUserPlanDTO(),await a.getBarChartData(),await a.getPieChartData(),await a.getEmailHistory(),n.value=!1}),(p,De)=>(m(),h(ae,{class:"q-pa-md"},{default:A(()=>[v(j,{class:te(p.$q.dark.isActive?"bg-style-dark no-shadow":"bg-style no-shadow")},{default:A(()=>[g("div",ve,[g("div",be,[g("div",ye,[g("div",we,[v(G,{icon:"email",title:`${d(t)("remainingEmails")}:`,loading:n.value,subtitle:b.value},null,8,["title","loading","subtitle"])]),g("div",Ae,[v(G,{icon:"work",title:`${d(t)("selectedPlan")}:`,loading:n.value,subtitle:i.value},null,8,["title","loading","subtitle"])])])]),g("div",_e,[l.value?(m(),h(me,{key:0,data:l.value,loading:n.value},null,8,["data","loading"])):T("",!0)]),g("div",Ce,[o.value?(m(),h(he,{key:0,data:o.value,loading:n.value},null,8,["data","loading"])):T("",!0)]),g("div",ke,[v(d(ne),{bordered:"",flat:"",columns:r.value,inline:!1,loading:n.value,"loading-label":d(t)("loadingData"),"no-data-label":d(t)("noDataAvailable"),"no-results-label":d(t)("noMatchedRecords"),rowsPerPageNum:6,rows:f.value?f.value:[],"rows-per-page-label":d(t)("recordsPerPage"),title:d(t)("emailHistory")},null,8,["columns","loading","loading-label","no-data-label","no-results-label","rows","rows-per-page-label","title"])])])]),_:1},8,["class"])]),_:1}))}});export{We as default};
